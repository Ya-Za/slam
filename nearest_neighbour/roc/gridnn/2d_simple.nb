(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     36783,       1071]
NotebookOptionsPosition[     36245,       1050]
NotebookOutlinePosition[     36591,       1065]
CellTagsIndexPosition[     36548,       1062]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Assumptions", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "s", ",", "x", ",", "y"}], "}"}], ",", "Reals"}], 
       "]"}], "&&", 
      RowBox[{"r", ">", "0"}], "&&", 
      RowBox[{"s", ">", "0"}], "&&", 
      RowBox[{"x", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"x", "\[LessEqual]", "s"}], "&&", 
      RowBox[{"y", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"y", "\[LessEqual]", "s"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Definitions", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"star", "[", 
      RowBox[{"x_", ",", "y_", ",", "r_", ",", "s_"}], "]"}], ":=", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], 
          RowBox[{"ArcCos", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "+", 
              RowBox[{"s", "/", "2"}]}], ")"}], "/", "r"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "+", 
            RowBox[{"s", "/", "2"}]}], ")"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"r", "^", "2"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "+", 
               RowBox[{"s", "/", "2"}]}], ")"}], "^", "2"}]}], "]"}]}]}]}], 
       "]"}], "+", 
      RowBox[{"Max", "[", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], 
          RowBox[{"ArcCos", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y", "+", 
              RowBox[{"s", "/", "2"}]}], ")"}], "/", "r"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"y", "+", 
            RowBox[{"s", "/", "2"}]}], ")"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"r", "^", "2"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "+", 
               RowBox[{"s", "/", "2"}]}], ")"}], "^", "2"}]}], "]"}]}]}]}], 
       "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"fn", "[", 
      RowBox[{"x_", ",", "y_", ",", "r_", ",", "s_"}], "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"star", "[", 
           RowBox[{"x", ",", "y", ",", "r", ",", "s"}], "]"}], ",", 
          RowBox[{"0", "\[LessEqual]", " ", "s", "\[LessEqual]", " ", 
           RowBox[{"2", "r"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"2", "r"}], "<", "s"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"1", "/", 
      RowBox[{"s", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FN", "[", 
     RowBox[{"r_", ",", "s_"}], "]"}], "=", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fn", "[", 
        RowBox[{"x", ",", "y", ",", "r", ",", "s"}], "]"}], 
       RowBox[{"p", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "s"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "s"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Prints", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"star", "[", 
     RowBox[{"x", ",", "y", ",", "r", ",", "s"}], "]"}], "//", 
    "TraditionalForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PiecewiseExpand", "[", 
      RowBox[{"star", "[", 
       RowBox[{"x", ",", "y", ",", "r", ",", "s"}], "]"}], "]"}], " ", "//", 
     "Simplify"}], " ", "//", " ", "TraditionalForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fn", "[", 
     RowBox[{"x", ",", "y", ",", "r", ",", "s"}], "]"}], "//", 
    "TraditionalForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PiecewiseExpand", "[", 
      RowBox[{"fn", "[", 
       RowBox[{"x", ",", "y", ",", "r", ",", "s"}], "]"}], "]"}], " ", "//", 
     "Simplify"}], " ", "//", " ", "TraditionalForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FN", "[", 
      RowBox[{"r", ",", "s"}], "]"}], "//", "Simplify"}], "//", 
    "TraditionalForm"}]}]}]], "Input",
 CellChangeTimes->{
  3.7034181451131554`*^9, 3.7034185548973927`*^9, {3.7034198723196964`*^9, 
   3.703419872814844*^9}, 3.7034199432733884`*^9, {3.7034200099176407`*^9, 
   3.703420010342326*^9}, {3.7034208582816153`*^9, 3.703420884811553*^9}, {
   3.70342105942871*^9, 3.7034210787111187`*^9}}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "s"], 
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", "s"], 
   RowBox[{
    FractionBox[
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["s", "2"], "+", "x"}], ")"}]}], " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["r", "2"], "-", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox["s", "2"], "+", "x"}], ")"}], "2"]}]]}], "+", 
                RowBox[{
                 SuperscriptBox["r", "2"], " ", 
                 RowBox[{"ArcCos", "[", 
                  FractionBox[
                   RowBox[{
                    FractionBox["s", "2"], "+", "x"}], "r"], "]"}]}]}]}], 
              "]"}], "+", 
             RowBox[{"Max", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["s", "2"], "+", "y"}], ")"}]}], " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["r", "2"], "-", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox["s", "2"], "+", "y"}], ")"}], "2"]}]]}], "+", 
                RowBox[{
                 SuperscriptBox["r", "2"], " ", 
                 RowBox[{"ArcCos", "[", 
                  FractionBox[
                   RowBox[{
                    FractionBox["s", "2"], "+", "y"}], "r"], "]"}]}]}]}], 
              "]"}]}], 
            RowBox[{"0", "\[LessEqual]", "s", "\[LessEqual]", 
             RowBox[{"2", " ", "r"}]}]},
           {"0", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False], 
     SuperscriptBox["s", "2"]], 
    RowBox[{"\[DifferentialD]", "y"}], 
    RowBox[{"\[DifferentialD]", "x"}]}]}]}]], "Output",
 CellChangeTimes->{3.703420964286487*^9, 3.7034279015235753`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"max", "(", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["cos", 
         RowBox[{"-", "1"}]], "(", 
        FractionBox[
         RowBox[{
          FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["s", "2"], "+", "x"}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["r", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox["s", "2"], "+", "x"}], ")"}], "2"]}]]}]}]}], ")"}], 
   "+", 
   RowBox[{"max", "(", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["cos", 
         RowBox[{"-", "1"}]], "(", 
        FractionBox[
         RowBox[{
          FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["s", "2"], "+", "y"}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["r", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox["s", "2"], "+", "y"}], ")"}], "2"]}]]}]}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.703420964286487*^9, 3.703427901545591*^9}],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {"\[Piecewise]", GridBox[{
        {
         RowBox[{
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{
            SuperscriptBox["cos", 
             RowBox[{"-", "1"}]], "(", 
            FractionBox[
             RowBox[{
              FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}], "-", 
          RowBox[{
           FractionBox["1", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"s", "+", 
             RowBox[{"2", " ", "x"}]}], ")"}], " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["r", "2"]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"s", "+", 
                RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}]}], 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "+", 
              RowBox[{"2", " ", "x"}]}], ")"}], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["r", "2"]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"s", "+", 
                 RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}], "<", 
           RowBox[{"4", " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{
             SuperscriptBox["cos", 
              RowBox[{"-", "1"}]], "(", 
             FractionBox[
              RowBox[{
               FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}]}], "\[And]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "+", 
              RowBox[{"2", " ", "y"}]}], ")"}], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["r", "2"]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"s", "+", 
                 RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}], 
           "\[GreaterEqual]", 
           RowBox[{"4", " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{
             SuperscriptBox["cos", 
              RowBox[{"-", "1"}]], "(", 
             FractionBox[
              RowBox[{
               FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}]}]}]},
        {
         RowBox[{
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{
            SuperscriptBox["cos", 
             RowBox[{"-", "1"}]], "(", 
            FractionBox[
             RowBox[{
              FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}], "-", 
          RowBox[{
           FractionBox["1", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"s", "+", 
             RowBox[{"2", " ", "y"}]}], ")"}], " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["r", "2"]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"s", "+", 
                RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}]}], 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "+", 
              RowBox[{"2", " ", "x"}]}], ")"}], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["r", "2"]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"s", "+", 
                 RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}], 
           "\[GreaterEqual]", 
           RowBox[{"4", " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{
             SuperscriptBox["cos", 
              RowBox[{"-", "1"}]], "(", 
             FractionBox[
              RowBox[{
               FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}]}], "\[And]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "+", 
              RowBox[{"2", " ", "y"}]}], ")"}], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["r", "2"]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"s", "+", 
                 RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}], "<", 
           RowBox[{"4", " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{
             SuperscriptBox["cos", 
              RowBox[{"-", "1"}]], "(", 
             FractionBox[
              RowBox[{
               FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}]}]}]},
        {
         RowBox[{
          FractionBox["1", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"s", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["r", "2"]}], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}]}], "-", 
            RowBox[{"2", " ", "x", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["r", "2"]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"s", "+", 
                  RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["r", "2"], " ", 
             RowBox[{
              SuperscriptBox["cos", 
               RowBox[{"-", "1"}]], "(", 
              FractionBox[
               RowBox[{
                FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}], "-", 
            RowBox[{"s", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["r", "2"]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"s", "+", 
                  RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}], "-", 
            RowBox[{"2", " ", "y", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["r", "2"]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"s", "+", 
                  RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["r", "2"], " ", 
             RowBox[{
              SuperscriptBox["cos", 
               RowBox[{"-", "1"}]], "(", 
              FractionBox[
               RowBox[{
                FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "+", 
              RowBox[{"2", " ", "x"}]}], ")"}], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["r", "2"]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"s", "+", 
                 RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}], "<", 
           RowBox[{"4", " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{
             SuperscriptBox["cos", 
              RowBox[{"-", "1"}]], "(", 
             FractionBox[
              RowBox[{
               FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}]}], "\[And]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "+", 
              RowBox[{"2", " ", "y"}]}], ")"}], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["r", "2"]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"s", "+", 
                 RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}], "<", 
           RowBox[{"4", " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{
             SuperscriptBox["cos", 
              RowBox[{"-", "1"}]], "(", 
             FractionBox[
              RowBox[{
               FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}]}]}]}
       },
       AllowedDimensions->{2, Automatic},
       Editable->True,
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}},
       Selectable->True]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxItemSize->{
     "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.35]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   "Piecewise",
   DeleteWithContents->True,
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.703420964286487*^9, 3.7034279016736746`*^9}],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {"\[Piecewise]", GridBox[{
        {
         RowBox[{
          RowBox[{"max", "(", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{
              SuperscriptBox["r", "2"], " ", 
              RowBox[{
               SuperscriptBox["cos", 
                RowBox[{"-", "1"}]], "(", 
               FractionBox[
                RowBox[{
                 FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox["s", "2"], "+", "x"}], ")"}], " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["r", "2"], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["s", "2"], "+", "x"}], ")"}], "2"]}]]}]}]}], 
           ")"}], "+", 
          RowBox[{"max", "(", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{
              SuperscriptBox["r", "2"], " ", 
              RowBox[{
               SuperscriptBox["cos", 
                RowBox[{"-", "1"}]], "(", 
               FractionBox[
                RowBox[{
                 FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox["s", "2"], "+", "y"}], ")"}], " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["r", "2"], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["s", "2"], "+", "y"}], ")"}], "2"]}]]}]}]}], 
           ")"}]}], 
         RowBox[{"0", "\[LessEqual]", "s", "\[LessEqual]", 
          RowBox[{"2", " ", "r"}]}]},
        {"0", 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->True]}
       },
       AllowedDimensions->{2, Automatic},
       Editable->True,
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}},
       Selectable->True]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxItemSize->{
     "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.35]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   "Piecewise",
   DeleteWithContents->True,
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.703420964286487*^9, 3.703427901700694*^9}],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {"\[Piecewise]", GridBox[{
        {"0", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"s", "+", 
                RowBox[{"2", " ", "x"}]}], ")"}], " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["r", "2"]}], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}], 
             "\[GreaterEqual]", 
             RowBox[{"4", " ", 
              SuperscriptBox["r", "2"], " ", 
              RowBox[{
               SuperscriptBox["cos", 
                RowBox[{"-", "1"}]], "(", 
               FractionBox[
                RowBox[{
                 FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}]}], "\[And]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"s", "+", 
                RowBox[{"2", " ", "y"}]}], ")"}], " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["r", "2"]}], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}], 
             "\[GreaterEqual]", 
             RowBox[{"4", " ", 
              SuperscriptBox["r", "2"], " ", 
              RowBox[{
               SuperscriptBox["cos", 
                RowBox[{"-", "1"}]], "(", 
               FractionBox[
                RowBox[{
                 FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}]}]}], ")"}], 
          "\[Or]", 
          RowBox[{
           RowBox[{"2", " ", "r"}], "<", "s"}]}]},
        {
         RowBox[{
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{
            SuperscriptBox["cos", 
             RowBox[{"-", "1"}]], "(", 
            FractionBox[
             RowBox[{
              FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}], "-", 
          RowBox[{
           FractionBox["1", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"s", "+", 
             RowBox[{"2", " ", "y"}]}], ")"}], " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["r", "2"]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"s", "+", 
                RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", "r"}], "\[GreaterEqual]", "s"}], "\[And]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "+", 
              RowBox[{"2", " ", "x"}]}], ")"}], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["r", "2"]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"s", "+", 
                 RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}], 
           "\[GreaterEqual]", 
           RowBox[{"4", " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{
             SuperscriptBox["cos", 
              RowBox[{"-", "1"}]], "(", 
             FractionBox[
              RowBox[{
               FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}]}]}]},
        {
         RowBox[{
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{
            SuperscriptBox["cos", 
             RowBox[{"-", "1"}]], "(", 
            FractionBox[
             RowBox[{
              FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}], "-", 
          RowBox[{
           FractionBox["1", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"s", "+", 
             RowBox[{"2", " ", "x"}]}], ")"}], " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["r", "2"]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"s", "+", 
                RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", "r"}], "\[GreaterEqual]", "s"}], "\[And]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "+", 
              RowBox[{"2", " ", "y"}]}], ")"}], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["r", "2"]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"s", "+", 
                 RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}], 
           "\[GreaterEqual]", 
           RowBox[{"4", " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{
             SuperscriptBox["cos", 
              RowBox[{"-", "1"}]], "(", 
             FractionBox[
              RowBox[{
               FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}]}]}]},
        {
         RowBox[{
          FractionBox["1", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"s", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["r", "2"]}], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}]}], "-", 
            RowBox[{"2", " ", "x", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["r", "2"]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"s", "+", 
                  RowBox[{"2", " ", "x"}]}], ")"}], "2"]}]]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["r", "2"], " ", 
             RowBox[{
              SuperscriptBox["cos", 
               RowBox[{"-", "1"}]], "(", 
              FractionBox[
               RowBox[{
                FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}], "-", 
            RowBox[{"s", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["r", "2"]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"s", "+", 
                  RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}], "-", 
            RowBox[{"2", " ", "y", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["r", "2"]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"s", "+", 
                  RowBox[{"2", " ", "y"}]}], ")"}], "2"]}]]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["r", "2"], " ", 
             RowBox[{
              SuperscriptBox["cos", 
               RowBox[{"-", "1"}]], "(", 
              FractionBox[
               RowBox[{
                FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}]}], ")"}]}], 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->True]}
       },
       AllowedDimensions->{2, Automatic},
       Editable->True,
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}},
       Selectable->True]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxItemSize->{
     "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.35]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   "Piecewise",
   DeleteWithContents->True,
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.703420964286487*^9, 3.7034279018137703`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", "s"], 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "0", "s"], 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SuperscriptBox["s", "2"]], 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             RowBox[{
              RowBox[{"max", "(", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["r", "2"], " ", 
                  RowBox[{
                   SuperscriptBox["cos", 
                    RowBox[{"-", "1"}]], "(", 
                   FractionBox[
                    RowBox[{
                    FractionBox["s", "2"], "+", "x"}], "r"], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["s", "2"], "+", "x"}], ")"}], " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["r", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox["s", "2"], "+", "x"}], ")"}], "2"]}]]}]}]}], 
               ")"}], "+", 
              RowBox[{"max", "(", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["r", "2"], " ", 
                  RowBox[{
                   SuperscriptBox["cos", 
                    RowBox[{"-", "1"}]], "(", 
                   FractionBox[
                    RowBox[{
                    FractionBox["s", "2"], "+", "y"}], "r"], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["s", "2"], "+", "y"}], ")"}], " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["r", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox["s", "2"], "+", "y"}], ")"}], "2"]}]]}]}]}], 
               ")"}]}], 
             RowBox[{"0", "\[LessEqual]", "s", "\[LessEqual]", 
              RowBox[{"2", " ", "r"}]}]},
            {"0", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False]}], 
     RowBox[{"\[DifferentialD]", "y"}], 
     RowBox[{"\[DifferentialD]", "x"}]}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.703420964286487*^9, 3.703441559233938*^9}]
}, Open  ]]
},
WindowSize->{678, 676},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4966, 139, 392, "Input"],
Cell[5549, 163, 3767, 102, 140, "Output"],
Cell[9319, 267, 1406, 49, 125, "Output"],
Cell[10728, 318, 9555, 275, 326, "Output"],
Cell[20286, 595, 3309, 94, 136, "Output"],
Cell[23598, 691, 8645, 248, 410, "Output"],
Cell[32246, 941, 3983, 106, 136, "Output"]
}, Open  ]]
}
]
*)

